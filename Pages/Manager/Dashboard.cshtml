@page
@model AuthTest.Pages.Manager.DashboardModel

<style>
            :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            @* position: sticky; *@
            top: 0;
            z-index: 100;
        }
.navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo i {
            margin-right: 10px;
        }

        .nav-links {
            display: flex;
            align-items: center;
            list-style: none;
        }

        .nav-links li {
            margin-left: 25px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover, .nav-links a.active {
            color: var(--primary);
        }

        .user-actions {
            display: flex;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: #4CAF50;
            color: white;
        }

        .btn-success:hover {
            background-color: #3d8b40;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.85rem;
        }

        /* Dashboard Layout */
        .dashboard {
            display: flex;
            margin-top: 30px;
            gap: 20px;
        }

        .sidebar {
            flex: 0 0 300px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            height: fit-content;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Card Styles */
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light-gray);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--light-gray);
            border-radius: 5px;
            font-size: 1rem;
        }

        /* Task Styles */
        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
            transition: background-color 0.3s;
        }

        .task-item:hover {
            background-color: var(--light);
        }

        .task-info h4 {
            margin-bottom: 5px;
        }

        .task-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .task-actions {
            display: flex;
            gap: 10px;
        }

        /* Base Badge Style */
.status-badge, .priority-badge {
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: inline-block;
    text-align: center;
    min-width: 70px;
}

/* Base Badge Style */
.status-badge, .priority-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: 1px solid;
    display: inline-block;
    text-align: center;
    min-width: 70px;
}

/* Project Status Badges */
.status-active {
    background-color: rgba(212, 237, 218, 0.2);
    color: #155724;
    @* border-color: rgba(195, 230, 203, 0.5); *@
}

.status-planning {
    background-color: rgba(255, 243, 205, 0.2);
    color: #856404;
    @* border-color: rgba(255, 238, 186, 0.5); *@
}

.status-on-hold {
    background-color: rgba(226, 227, 229, 0.2);
    color: #383d41;
    @* border-color: rgba(214, 216, 219, 0.5); *@
}

.status-completed {
    background-color: rgba(209, 236, 241, 0.2);
    color: #0c5460;
    @* border-color: rgba(190, 229, 235, 0.5); *@
}

.status-cancelled {
    background-color: rgba(248, 215, 218, 0.2);
    color: #721c24;
    @* border-color: rgba(245, 198, 203, 0.5); *@
}

/* Task Status Badges */
.status-todo {
    background-color: rgba(233, 236, 239, 0.2);
    color: #495057;
    @* border-color: rgba(222, 226, 230, 0.5); *@
}

.status-in-progress {
    background-color: rgba(204, 231, 255, 0.2);
    color: #004085;
    @* border-color: rgba(179, 215, 255, 0.5); *@
}

.status-review {
    background-color: rgba(255, 243, 205, 0.2);
    color: #856404;
    @* border-color: rgba(255, 238, 186, 0.5); *@
}

.status-done {
    background-color: rgba(212, 237, 218, 0.2);
    color: #155724;
    @* border-color: rgba(195, 230, 203, 0.5); *@
}

.status-blocked {
    background-color: rgba(248, 215, 218, 0.2);
    color: #721c24;
    @* border-color: rgba(245, 198, 203, 0.5); *@
}

/* Priority Badges */
.priority-critical {
    background-color: rgba(220, 53, 69, 0.2);
    color: #dc3545;
    border-color: rgba(220, 53, 69, 0.3);
}

.priority-high {
    background-color: rgba(253, 126, 20, 0.2);
    color: #fd7e14;
    border-color: rgba(253, 126, 20, 0.3);
}

.priority-medium {
    background-color: rgba(255, 193, 7, 0.2);
    color: #856404;
    border-color: rgba(255, 193, 7, 0.3);
}

.priority-low {
    background-color: rgba(40, 167, 69, 0.2);
    color: #155724;
    border-color: rgba(40, 167, 69, 0.3);
}

/* Optional: Small badge variant */
.badge-sm {
    padding: 4px 8px;
    font-size: 0.7rem;
    min-width: 60px;
}

/* Optional: Large badge variant */
.badge-lg {
    padding: 8px 16px;
    font-size: 0.8rem;
    min-width: 80px;
}

/* Optional: Small badge variant */
.badge-sm {
    padding: 3px 8px;
    font-size: 0.7rem;
    min-width: 60px;
}

/* Optional: Large badge variant */
.badge-lg {
    padding: 8px 16px;
    font-size: 0.9rem;
    min-width: 80px;
}

        /* Tab Styles */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        /* User List Styles */
        .user-list {
            display: grid;
            @* grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); *@
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .user-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .user-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--light-gray);
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--gray);
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info h4 {
            margin-bottom: 5px;
        }

        .user-info p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .user-tasks {
            border-top: 1px solid var(--light-gray);
            padding-top: 15px;
        }

        .user-task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .user-task-item:last-child {
            border-bottom: none;
        }

        .user-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
        }

        /* Filter Section */
        .filter-section {
            margin-bottom: 25px;
        }

        .filter-section h3 {
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .projects-list {
            list-style: none;
            margin-top: 10px;
        }

        .project-item {
            padding: 10px 0;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .project-item:last-child {
            border-bottom: none;
        }

        .collapse-section {
            margin-top: 20px;
        }

        .collapse-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 10px 0;
        }

        .collapse-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapse-content.expanded {
            max-height: 500px;
        }

        /* Stats Section */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Task Categories */
        .task-categories {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .task-category {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light-gray);
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .category-count {
            background-color: var(--primary);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .action-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .action-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .action-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .action-desc {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Responsive Styles */
        @@media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }

            .sidebar {
                flex: 0 0 auto;
            }

            .nav-links {
                display: none;
            }
        }

        @* --------------------------- *@

        .user-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid var(--light-gray);
}
@* --------------------------- *@

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

/* Compact Modal Styles */
.compact-modal {
    max-width: 450px;
}

.compact-modal .modal-body {
    padding: 20px;
}

.compact-modal .form-group {
    margin-bottom: 15px;
}

.compact-modal .form-label {
    font-size: 0.9rem;
    margin-bottom: 6px;
}

.compact-modal .form-control {
    padding: 10px 12px;
    font-size: 0.9rem;
}

.compact-modal textarea.form-control {
    min-height: 80px;
    resize: vertical;
}

.compact-modal .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 15px;
}

.compact-modal .form-row .form-group {
    margin-bottom: 0;
}

.compact-modal .modal-header {
    padding: 20px 20px 15px;
}

.compact-modal .modal-header h3 {
    font-size: 1.2rem;
}

.compact-modal .modal-actions {
    margin-top: 20px;
    padding-top: 15px;
    gap: 10px;
}

.compact-modal .btn {
    padding: 10px 16px;
    font-size: 0.9rem;
}

#invite-member-form {
    padding: 10px;
}
#new-project-form {
    padding: 10px;
}

/* Responsive adjustments for compact modal */
@@media (max-width: 480px) {
    .compact-modal {
        max-width: 100%;
        margin: 10px;
    }
    
    .compact-modal .form-row {
        grid-template-columns: 1fr;
        gap: 0;
    }
    
    .compact-modal .modal-body {
        padding: 15px;
    }
}

.modal-content {
    background-color: white;
    border-radius: 12px;
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    animation: modalSlideIn 0.3s ease-out;
}

@@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 30px 20px;
    border-bottom: 2px solid var(--light-gray);
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-radius: 12px 12px 0 0;
}

.modal-header h3 {
    font-size: 1.4rem;
    font-weight: 600;
    margin: 0;
}

.close-modal {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.2rem;
}

.close-modal:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: rotate(90deg);
}

.modal-body {
    padding: 30px;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    font-weight: 600;
    color: var(--dark);
    margin-bottom: 8px;
    font-size: 0.95rem;
}

.form-control {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid var(--light-gray);
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background-color: white;
}

.form-control:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
}

textarea.form-control {
    resize: vertical;
    min-height: 100px;
}

.form-row {
    display: flex;
    gap: 15px;
}

.form-row .form-group {
    flex: 1;
}

.validation-message {
    color: #dc3545;
    font-size: 0.85rem;
    margin-top: 6px;
    display: block;
}

.modal-actions {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
    margin-top: 25px;
    padding-top: 20px;
    border-top: 2px solid var(--light-gray);
}

.btn {
    padding: 12px 24px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    font-size: 0.95rem;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background-color: var(--primary);
    color: white;
    border: 2px solid var(--primary);
}

.btn-primary:hover {
    background-color: var(--secondary);
    border-color: var(--secondary);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(67, 97, 238, 0.2);
}

.btn-outline {
    background-color: transparent;
    border: 2px solid var(--light-gray);
    color: var(--dark);
}

.btn-outline:hover {
    border-color: var(--primary);
    color: var(--primary);
    transform: translateY(-1px);
}

.project-selection-section {
    background: var(--light);
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    border-left: 4px solid var(--primary);
}

.project-selection-section .form-label {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--primary);
    font-weight: 600;
}

.project-selection-section .form-label::before {
    content: "üìÅ";
    font-size: 1.1rem;
}

.task-form-section {
    padding: 10px 0;
}

/* Responsive */
@@media (max-width: 768px) {
    .modal-content {
        max-width: 100%;
        margin: 10px;
    }
    
    .modal-body {
        padding: 20px;
    }
    
    .form-row {
        flex-direction: column;
        gap: 0;
    }
    
    .modal-actions {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
}

/* Loading state for form submission */
.form-submitting {
    opacity: 0.7;
    pointer-events: none;
}

.form-submitting .btn-primary::after {
    content: "";
    width: 16px;
    height: 16px;
    border: 2px solid transparent;
    border-top: 2px solid white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-left: 8px;
}

@@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@* ----------------------------- *@

/* Project Codes Container */
.project-codes-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* Project Code Item */
.project-code-item {
    background: white;
    border: 1px solid var(--light-gray);
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.3s ease;
}

.project-code-item:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(67, 97, 238, 0.1);
}

/* Project Code Header */
.project-code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.project-code-header:hover {
    background-color: var(--light);
}

.project-info {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
}

.project-icon {
    width: 44px;
    height: 44px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.1rem;
}

.project-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--dark);
    margin-bottom: 4px;
}

.project-meta {
    font-size: 0.85rem;
    color: var(--gray);
}

.project-actions {
    display: flex;
    align-items: center;
    gap: 15px;
}

/* Chevron Button */
.chevron-btn {
    background: none;
    border: none;
    color: var(--gray);
    cursor: pointer;
    padding: 8px;
    border-radius: 6px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.chevron-btn:hover {
    background-color: var(--light-gray);
    color: var(--primary);
}

.chevron-btn i {
    transition: transform 0.3s ease;
}

.project-code-item.active .chevron-btn i {
    transform: rotate(180deg);
}

/* Project Codes Content */
.project-codes-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background-color: var(--light);
}

.project-code-item.active .project-codes-content {
    max-height: 500px;
}

.codes-list {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Code Item */
.code-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: white;
    border-radius: 8px;
    border: 1px solid var(--light-gray);
    transition: all 0.2s ease;
}

.code-item:hover {
    border-color: var(--primary);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.code-text {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.95rem;
    font-weight: 500;
    color: var(--dark);
    letter-spacing: 0.5px;
}

.copy-code {
    padding: 6px 12px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: all 0.2s ease;
}

.copy-code:hover {
    background-color: var(--primary);
    color: white;
    transform: translateY(-1px);
}

/* Status Badges */
.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-active {
    background-color: #d4edda;
    color: #155724;
}

.status-planning {
    background-color: #fff3cd;
    color: #856404;
}

/* Animation for accordion */
@@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.project-code-item.active .codes-list {
    animation: slideDown 0.3s ease;
}


</style>

<div class="container">
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Task Filters -->
            <div class="filter-section">
                <h3>Filter Tasks</h3>
                <div class="filter-options">
                    <div class="filter-option">
                        <input type="checkbox" id="member-filter-today" checked>
                        <label for="member-filter-today">Due Today</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="member-filter-week" checked>
                        <label for="member-filter-week">This Week</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="member-filter-overdue" checked>
                        <label for="member-filter-overdue">Overdue</label>
                    </div>
                    <form method="post" asp-page-handler="FilterTasks">
                        <div class="form-group">
                        <label asp-for="Filter.SelectedStatusId" class="form-label"></label>
                        <select asp-for="Filter.SelectedStatusId" asp-items="@Model.TasksStatus" class="form-control">
                            <option value="0">All Statuses</option>
                        </select>
                        <span asp-validation-for="Filter.SelectedStatusId"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Filter.SelectedPriorityId" class="form-label"></label>
                        <select asp-for="Filter.SelectedPriorityId" asp-items="@Model.TasksPriority" class="form-control">
                            <option value="0">All Priorities</option>
                        </select>
                        <span asp-validation-for="Filter.SelectedPriorityId"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Filter.SelectedMemberId" class="form-label"></label>
                        <select asp-for="Filter.SelectedMemberId" asp-items="@Model.AllProjectMembersDropdown" class="form-control">
                            <option value="">All Members</option>
                        </select>
                        <span asp-validation-for="Filter.SelectedMemberId"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Filter.SelectedProjectId" class="form-label"></label>
                        <select asp-for="Filter.SelectedProjectId" asp-items="@Model.ManagerProjectsDropdown" class="form-control">
                            <option value="0">All Projects</option>
                        </select>
                        <span asp-validation-for="Filter.SelectedProjectId"></span>
                    </div>
                    <button type="submit" class="btn btn-primary">Filter</button>
                    </form>
                </div>
            </div>

            <!-- My Projects -->
            <div class="filter-section">
                <h3>My Projects</h3>
                <ul class="projects-list">
                    @if(Model.ManagerProjects != null && Model.ManagerProjects.Any())
                        {
                            @foreach(var project in Model.ManagerProjects)
                            {
                                <li class="project-item">
                                    <span>@project?.Name</span>
                                    <span class="status-badge @project?.Status?.CssClassName">@project?.Status?.Name</span>
                                </li>
                            }
                        }
                </ul>
            </div>

            <!-- All Projects -->
            <div class="collapse-section">
                <div class="collapse-header" id="all-projects-toggle">
                    <h3>All Projects</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="collapse-content" id="all-projects-content">
                    <ul class="projects-list">
                        @if(Model.AllProjects != null && Model.AllProjects.Any())
                            {
                        @foreach(var project in Model.AllProjects)
                                {
                        <li class="project-item">
                            <span>@project?.Name</span>
                            <span class="status-badge @project?.Status?.CssClassName">@project?.Status?.Name</span>
                        </li>
                                }
                            }
                    </ul>
                </div>
            </div>

            <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" id="new-project-btn">
                <i class="fas fa-plus"></i> New Project
            </button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Quick Actions</h3>
                </div>
                <div class="quick-actions">
                    <div class="action-card" id="create-task-action">
                        <div class="action-icon">
                            <i class="fas fa-plus-circle"></i>
                        </div>
                        <div class="action-title">Create Task</div>
                        <div class="action-desc">Add a new task to a project</div>
                    </div>
                    <div class="action-card" id="invite-member-action">
                        <div class="action-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="action-title">Invite Member</div>
                        <div class="action-desc">Add a new team member</div>
                    </div>
                </div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value">@(Model?.Tasks?.Count ?? 0)</div>
                    <div class="stat-label">Total Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">@(Model?.OverdueTasks?.Count ?? 0)</div>
                    <div class="stat-label">Overdue</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">@(Model?.WeekTasks?.Count ?? 0)</div>
                    <div class="stat-label">Due This Week</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">@(Model?.Project?.ProjectMembers?.Count ?? 0)</div>
                    <div class="stat-label">Team Members</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">@(Model?.ManagerProjects?.Count ?? 0)</div>
                    <div class="stat-label">Active Projects</div>
                </div>
            </div>

            <!-- Task Categories -->
            <div class="task-categories">
                <!-- Due Today -->
                <div class="task-category" id="today-tasks">
                    <div class="category-header">
                        <div class="category-title">Due Today</div>
                        <div class="category-count">@(Model?.DueTodayTasks?.Count ?? 0)</div>
                    </div>
                    <ul class="task-list">
                        @if(Model.DueTodayTasks != null && Model.DueTodayTasks.Any())
                            {
                        @foreach(var task in Model.DueTodayTasks)
                                {
                        <li class="task-item">
                            <div class="task-info">
                                <h4>@task.Title</h4>
                                <div class="task-meta">
                                    <span>Assigned to: @task?.AssignedToMember?.FullName</span>
                                    <span class="priority-badge @task?.Priority?.CssClassName">@task?.Priority?.Name</span>
                                </div>
                            </div>
                            <div class="task-actions">
                                <span class="status-badge @task?.Status?.CssClassName">@task?.Status?.Name</span>
                            </div>
                        </li>
                                }
                            }
                    </ul>
                </div>

                <!-- This Week -->
                <div class="task-category" id="this-week-tasks">
                    <div class="category-header">
                        <div class="category-title">This Week</div>
                        <div class="category-count">@(Model?.WeekTasks?.Count ?? 0)</div>
                    </div>
                    <ul class="task-list">
                        @if(Model?.WeekTasks != null && Model.WeekTasks.Any())
                        {
                        @foreach(var task in Model?.WeekTasks)
                            {
                        <li class="task-item">
                            <div class="task-info">
                                <h4>@task?.Title</h4>
                                <div class="task-meta">
                                    <span>Assigned to: @task?.AssignedToMember?.FullName</span>
                                    <span class="priority-badge @task?.Priority?.CssClassName">@task?.Priority?.Name</span>
                                </div>
                            </div>
                            <div class="task-actions">
                                <a asp-page="/Manager/Read" asp-route-taskId="@task.Id" class="btn btn-primary">View</a>
                                <span class="status-badge @task.Status.CssClassName">@task.Status.Name</span>
                            </div>
                        </li>
                            }
                        }
                    </ul>
                </div>

                <!-- Overdue -->
                <div class="task-category" id="overdue-task">
                    <div class="category-header">
                        <div class="category-title">Overdue Tasks</div>
                        <div class="category-count">@(Model?.OverdueTasks?.Count ?? 0)</div>
                    </div>
                    <ul class="task-list">
                        @if(Model.OverdueTasks != null && Model.OverdueTasks.Any())
                        {
                            foreach(var task in Model.OverdueTasks)
                            {
                        <li class="task-item">
                            <div class="task-info">
                                <h4>@task.Title</h4>
                                <div class="task-meta">
                                    <span>Assigned to: @task.AssignedToMember.FullName</span>
                                    <span class="priority-badge @task.Priority.CssClassName">@task.Priority.Name</span>
                                </div>
                            </div>
                            <div class="task-actions">
                                <span class="status-badge @task.Status.CssClassName">@task.Status.Name</span>
                            </div>
                        </li>
                            }
                        }
                    </ul>
                </div>
                <div class="card" style="width: 1000px;">
                    <div class="card-header">
                        <h3 class="card-title">Team Members</h3>
                        @* <button class="btn btn-primary" id="invite-member-btn">
                            <i class="fas fa-user-plus"></i> Invite Member
                        </button> *@
                    </div>
                    <div class="user-list">
                        @if(Model?.AllProjectMembers != null && Model.AllProjectMembers.Any())
                        {
                            @foreach (var member in Model.AllProjectMembers)
{
    <div class="user-card">
        <div class="user-header">
            <div class="user-avatar">
                <img src="@member.ProfilePictureUrl" style="width:50px;" />
            </div>
            <div class="user-info">
                <h4>@member.FullName</h4>
                <p>@member.MemberProfile?.JobTitle</p>
            </div>
        </div>

        @* <div class="user-tasks">
            @{
                var tasks = member.MemberProfile?.Tasks;
                var totalTasks = tasks?.Count ?? 0;
                var completed = tasks?.Count(t => t.IsCompleted) ?? 0;
            }

            <div class="user-task-item">
                <span>Tasks: @totalTasks</span>
                <span>Completed: @completed</span>
            </div>
        </div> *@

        <div class="user-actions">
            <button class="btn btn-outline btn-sm view-member-details">
                <i class="fas fa-eye"></i> View Details
            </button>
        </div>
    </div>
}
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Invite Member Modal -->
<div class="modal" id="invite-member-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Invite Team Member</h3>
            <button class="close-modal">&times;</button>
        </div>
        <form method="post" asp-page-handler="CreateInvitationCode" id="invite-member-form">
            <div class="form-group">
                <label asp-for="InviteForm.ProjectId" class="form-label"></label>
                <select asp-for="InviteForm.ProjectId"
                        asp-items="@Model.ManagerProjectsDropdown"
                        class="form-control"
                        id="project-select">
                    <option value="">Choose a project...</option>
                </select>
                <span asp-validation-for="InviteForm.ProjectId"></span>
            </div>

            <div class="form-group">
                <label asp-for="InviteForm.Number" class="form-label"></label>
                <input asp-for="InviteForm.Number" type="number" class="form-control" id="invitation-count" value="1" />
                <span asp-validation-for="InviteForm.Number"></span>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                <button type="button" class="btn btn-outline close-modal">Cancel</button>
                <button type="submit" class="btn btn-primary">Generate Invitation Codes</button>
            </div>
        </form>

        <!-- Codes List -->
        <div id="codes-list" style="margin-top: 20px;">
            @if(Model.InviteCodes != null && Model.InviteCodes.Any())
            {
            @foreach(var group in Model.InviteCodes)
                {
            <div class="project-code-item">
                <div class="project-code-header">
                    <div class="project-info">
                        <i class="fas fa-folder project-icon"></i>
                        <div>
                            <h4 class="project-name">@group.Project.Name</h4>
                            <span class="project-meta">@group.Codes.Count active codes</span>
                        </div>
                    </div>
                    <div class="project-actions">
                        <span class="status-badge status-active">Active</span>
                        <button class="chevron-btn">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
                <div class="project-codes-content">
                    <div class="codes-list">
                        @foreach(var code in group.Codes)
                    {
                        <div class="code-item">
                            <span class="code-text">@(@code)</span>
                            <button class="btn btn-outline btn-sm copy-code">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    }
                    </div>
                </div>
            </div>
                }
            }
        </div>
    </div>
</div>
<!-- Create Task Modal -->
<div class="modal" id="create-task-modal">
    <div class="modal-content compact-modal">
        <div class="modal-header" style="display: none;">
            <h3>Create New Task</h3>
            <button class="close-modal">&times;</button>
        </div>
        
        <div class="modal-body">
            <!-- Project Selection -->
            <form method="get">
                <div class="form-group">
                <label asp-for="SelectedProjectId" class="form-label">Project</label>
                <select asp-for="SelectedProjectId"
                        asp-items="@Model.ManagerProjectsDropdown"
                        class="form-control"
                        id="task-project"
                        onchange="this.form.submit()">
                    <option value="">Select a project...</option>
                </select>
                <span asp-validation-for="SelectedProjectId" class="validation-message"></span>
            </div>
            </form>

            <!-- Task Creation Form -->
            <form method="post" asp-page-handler="CreateTask" asp-route-SelectedProjectId="@Model.SelectedProjectId">
                <!-- Row 1: Title -->
                <div class="form-group">
                    <label asp-for="CreateTaskForm.Title" class="form-label">Task Title</label>
                    <input asp-for="CreateTaskForm.Title" type="text" class="form-control" id="task-title" placeholder="Enter task title" required>
                    <span asp-validation-for="CreateTaskForm.Title" class="validation-message"></span>
                </div>

                <!-- Row 2: Assign To & Due Date -->
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="CreateTaskForm.AssignedToMemberId" class="form-label">Assign To</label>
                        <select asp-for="CreateTaskForm.AssignedToMemberId" asp-items="@Model.SelectedProjectMembersDropdown" class="form-control" id="task-member" required>
                            <option value="">Select member...</option>
                        </select>
                        <span asp-validation-for="CreateTaskForm.AssignedToMemberId" class="validation-message"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="CreateTaskForm.DueDate" class="form-label">Due Date</label>
                        <input asp-for="CreateTaskForm.DueDate" type="date" class="form-control" id="task-due-date" required>
                        <span asp-validation-for="CreateTaskForm.DueDate" class="validation-message"></span>
                    </div>
                </div>

                <!-- Row 3: Priority -->
                <div class="form-group">
                    <label asp-for="CreateTaskForm.PriorityId" class="form-label">Priority</label>
                    <select asp-for="CreateTaskForm.PriorityId" asp-items="@Model.TasksPriority" class="form-control" id="task-priority" required>
                        <option value="">Select priority...</option>
                    </select>
                    <span asp-validation-for="CreateTaskForm.PriorityId" class="validation-message"></span>
                </div>

                <!-- Row 4: Description -->
                <div class="form-group">
                    <label asp-for="CreateTaskForm.Description" class="form-label">Description</label>
                    <textarea asp-for="CreateTaskForm.Description" class="form-control" id="task-description" placeholder="Enter task description" rows="3"></textarea>
                    <span asp-validation-for="CreateTaskForm.Description" class="validation-message"></span>
                </div>

                <!-- Action Buttons -->
                <div class="modal-actions">
                    <a asp-page="/Manager/Dashboard" class="btn btn-outline">Cancel</a>
                    <button type="submit" class="btn btn-primary">Create Task</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- New Project Modal -->
<div class="modal" id="new-project-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create New Project</h3>
            <button class="close-modal">&times;</button>
        </div>
        <form method="post" asp-page-handler="CreateProject" id="new-project-form">
            <div class="form-group">
                <label asp-for="NewProjectForm.Name" class="form-label"></label>
                <input asp-for="NewProjectForm.Name" type="text" class="form-control" id="project-name" placeholder="Enter project name">
                <span asp-validation-for="NewProjectForm.Name"></span>
            </div>

            <div class="form-group">
                <label asp-for="NewProjectForm.Description" class="form-label"></label>
                <textarea asp-for="NewProjectForm.Description" class="form-control" id="project-description" placeholder="Enter project description"></textarea>
                <span asp-validation-for="NewProjectForm.Description"></span>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                <button type="button" class="btn btn-outline close-modal">Cancel</button>
                <button type="submit" class="btn btn-primary">Create Project</button>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {

    /* ==============================
       COLLAPSE: ALL PROJECTS
    ============================== */
    const allProjectsToggle = document.getElementById('all-projects-toggle');
    const allProjectsContent = document.getElementById('all-projects-content');

    if (allProjectsToggle && allProjectsContent) {
        allProjectsToggle.addEventListener('click', function() {
            allProjectsContent.classList.toggle('expanded');
            const icon = this.querySelector('i');
            if (icon) {
                icon.classList.toggle('fa-chevron-down');
                icon.classList.toggle('fa-chevron-up');
            }
        });
    }

    /* ==============================
       VIEW INVITE CODES
    ============================== */
    const projectCodeItems = document.querySelectorAll('.project-code-item');
    const copyCodeButtons = document.querySelectorAll('.copy-code');

    projectCodeItems.forEach(item => {
        const header = item.querySelector('.project-code-header');
        if (!header) return;

        header.addEventListener('click', function() {
            // Close all other items
            projectCodeItems.forEach(other => {
                if (other !== item) other.classList.remove('active');
            });
            // Toggle current
            item.classList.toggle('active');
        });
    });

    // Copy code buttons
    copyCodeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const codeText = this.closest('.code-item')?.querySelector('.code-text')?.textContent;
            if (!codeText) return;

            navigator.clipboard.writeText(codeText).then(() => {
                const original = this.innerHTML;
                this.innerHTML = '<i class="fas fa-check"></i> Copied!';
                this.classList.remove('btn-outline');
                this.classList.add('btn-success');
                setTimeout(() => {
                    this.innerHTML = original;
                    this.classList.remove('btn-success');
                    this.classList.add('btn-outline');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy code:', err);
                alert('Failed to copy code to clipboard');
            });
        });
    });

    /* ==============================
       QUICK ACTIONS & MODALS
    ============================== */
    const createTaskAction = document.getElementById('create-task-action');
    const createProjectAction = document.getElementById('new-project-btn');
    const inviteMemberAction = document.getElementById('invite-member-action');

    const createTaskModal = document.getElementById('create-task-modal');
    const createProjectModal = document.getElementById('new-project-modal');
    const inviteMemberModal = document.getElementById('invite-member-modal');
    const viewCodesModal = document.getElementById('view-codes-modal');

    // Create Project
    if (createProjectAction) {
        createProjectAction.addEventListener('click', function() {
            if (createProjectModal) createProjectModal.style.display = 'flex';
        });
    }

    // Create Task
    if (createTaskAction) {
        createTaskAction.addEventListener('click', function() {
            if (createTaskModal) {
                createTaskModal.style.display = 'flex';
                const today = new Date().toISOString().split('T')[0];
                const dueDateInput = document.getElementById('task-due-date');
                if (dueDateInput) dueDateInput.value = today;
            }
        });
    }

    // Invite Member
    if (inviteMemberAction) {
        inviteMemberAction.addEventListener('click', function() {
            if (inviteMemberModal) inviteMemberModal.style.display = 'flex';
        });
    }

    /* ==============================
       CLOSE MODALS
    ============================== */
    const closeModalBtns = document.querySelectorAll('.close-modal');
    closeModalBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const modal = this.closest('.modal');
            if (modal) modal.style.display = 'none';
        });
    });

    // Click outside to close
    window.addEventListener('click', function(event) {
        [createTaskModal, createProjectModal, inviteMemberModal, viewCodesModal].forEach(modal => {
            if (event.target === modal) modal.style.display = 'none';
        });
    });


    /* ==============================
       CHECKBOX FILTERS (appear/disappear)
    ============================== */
    const filterPairs = {
        "member-filter-today": "today-tasks",
        "member-filter-week": "this-week-tasks",
        "member-filter-overdue": "overdue-task"
        };

    Object.entries(filterPairs).forEach(([checkboxId, sectionId]) => {
        const checkbox = document.getElementById(checkboxId);
        const section = document.getElementById(sectionId);
        if (!checkbox || !section) return;

        // Initial visibility
        section.style.display = checkbox.checked ? "block" : "none";

        // Toggle on change
        checkbox.addEventListener("change", function() {
            section.style.display = this.checked ? "block" : "none";
        });
    });

});
</script>